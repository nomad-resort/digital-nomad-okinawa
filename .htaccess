# ----------------------------
# Static Landing Page .htaccess
# ----------------------------

# Disable directory listing
Options -Indexes

# Serve a default index file
DirectoryIndex index.html

# -------------------------------------------------
# Canonical host + HTTPS (pick ONE canonical style)
# -------------------------------------------------
RewriteEngine On

# 1) Force HTTPS
RewriteCond %{HTTPS} !=on
RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [R=301,L]

# 2) Force NON-WWW (recommended)
RewriteCond %{HTTP_HOST} ^www\.(.+)$ [NC]
RewriteRule ^ https://%1%{REQUEST_URI} [R=301,L]


# ----------------------------
# Clean URLs (optional)
# If you have /about (about.html)
# ----------------------------
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME}.html -f
RewriteRule ^(.+?)/?$ $1.html [L]


# ----------------------------
# Caching (performance)
# ----------------------------
<IfModule mod_expires.c>
  ExpiresActive On

  # HTML: short cache
  ExpiresByType text/html "access plus 5 minutes"

  # CSS/JS: long cache
  ExpiresByType text/css "access plus 1 year"
  ExpiresByType application/javascript "access plus 1 year"
  ExpiresByType text/javascript "access plus 1 year"

  # Images: long cache
  ExpiresByType image/png "access plus 1 year"
  ExpiresByType image/jpeg "access plus 1 year"
  ExpiresByType image/gif "access plus 1 year"
  ExpiresByType image/webp "access plus 1 year"
  ExpiresByType image/avif "access plus 1 year"
  ExpiresByType image/svg+xml "access plus 1 year"
  ExpiresByType image/x-icon "access plus 1 year"

  # Fonts: long cache
  ExpiresByType font/woff2 "access plus 1 year"
  ExpiresByType font/woff "access plus 1 year"

  # Videos: long cache
  ExpiresByType video/mp4 "access plus 1 year"
  ExpiresByType video/webm "access plus 1 year"
  ExpiresByType video/ogg "access plus 1 year"
</IfModule>

<IfModule mod_headers.c>
  # Prevent caching of HTML too aggressively
  <FilesMatch "\.(html)$">
    Header set Cache-Control "no-cache, must-revalidate"
  </FilesMatch>

  # Cache versioned assets hard (best if filenames contain hashes: app.8c1a2.js)
  <FilesMatch "\.(css|js|png|jpe?g|gif|webp|avif|svg|ico|woff2?|ttf|mp4|webm|ogg)$">
    Header set Cache-Control "public, max-age=31536000, immutable"
  </FilesMatch>
</IfModule>


# ----------------------------
# Compression
# ----------------------------
<IfModule mod_deflate.c>
  AddOutputFilterByType DEFLATE text/plain
  AddOutputFilterByType DEFLATE text/html
  AddOutputFilterByType DEFLATE text/xml
  AddOutputFilterByType DEFLATE text/css
  AddOutputFilterByType DEFLATE text/javascript
  AddOutputFilterByType DEFLATE application/xml
  AddOutputFilterByType DEFLATE application/xhtml+xml
  AddOutputFilterByType DEFLATE application/rss+xml
  AddOutputFilterByType DEFLATE application/javascript
  AddOutputFilterByType DEFLATE application/x-javascript
  AddOutputFilterByType DEFLATE application/json
  AddOutputFilterByType DEFLATE application/x-font-ttf
  AddOutputFilterByType DEFLATE application/x-font-opentype
  AddOutputFilterByType DEFLATE application/vnd.ms-fontobject
  AddOutputFilterByType DEFLATE image/svg+xml
</IfModule>


# ----------------------------
# Basic security headers
# ----------------------------
<IfModule mod_headers.c>
  Header always set X-Content-Type-Options "nosniff"
  Header always set Referrer-Policy "strict-origin-when-cross-origin"
</IfModule>


# ----------------------------
# Block access to hidden files
# ----------------------------
<FilesMatch "^\.">
  Require all denied
</FilesMatch>
